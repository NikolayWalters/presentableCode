from PyAstronomy import pyasl
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import gridspec
from pylab import rc
from matplotlib.ticker import (MultipleLocator, FormatStrFormatter,
                               AutoMinorLocator)
from matplotlib import transforms
from pylab import *
rcParams['font.family'] = 'serif'
rcParams['font.sans-serif'] = ['Times']

plt.rc('xtick',c='k')
rc('axes', linewidth=2)
plt.rc('ytick',c='k')
plt.subplots_adjust(hspace = 0)
plt.subplots_adjust(wspace = 0)
fig, ax1 = plt.subplots(4, 2,gridspec_kw={'hspace': 0., 'wspace': 0.0},figsize=(20,20))

leftylim1 = 0.84
leftylim2 = 1.12
rightxlim1 = 3930.00001
rightxlim2 = 3936.99999
modelColour = 'b'
dataColour = 'gray'
#NLTT
wavel = [3929.000,3929.200,3929.400,3929.600,3929.800,3930.000,3930.200,3930.400,3930.600,3930.800,3931.000,3931.200,3931.400,3931.600,3931.800,3932.000,3932.200,3932.400,3932.600,3932.800,3933.000,3933.200,3933.400,3933.600,3933.800,3934.000,3934.200,3934.400,3934.600,3934.800,3935.000,3935.200,3935.400,3935.600,3935.800,3936.000,3936.200,3936.400,3936.600,3936.800,3937.000]
flux = [0.9776585,0.9989457,0.9855685,0.9989466,1.012660,1.000829,0.9934337,0.9922941,0.9824561,0.9940172,1.015069,1.012661,1.010980,1.003149,0.9903809,0.9783425,0.9782812,0.9840768,1.008155,1.001752,0.9975455,0.9841902,0.9947370,1.014683,1.012356,1.014347,1.002806,0.9962560,0.9863568,0.9714888,0.9928777,1.019592,0.9915661,0.9699916,0.9880240,0.9950954,0.9780828,0.9809298,0.9956195,1.011282,1.018628]
fitW = [3910,3930.000,3930.200,3930.400,3930.600,3930.800,3931.000,3931.200,3931.400,3931.600,3931.800,3932.000,3932.200,3932.400,3932.600,3932.800,3933.000,3933.200,3933.400,3933.600,3933.800,3934.000,3934.200,3934.400,3934.600,3934.800,3935.000,3935.200,3935.400,3935.600,3935.800,3936.000,3960]
fitF = [1,0.9999868,0.9999962,1.000003,1.000007,1.000009,1.000007,1.000000,0.9999884,0.9999720,0.9999504,0.9999221,0.9998861,0.9998316,0.9996856,0.9990997,0.9965021,0.9896932,0.9789521,0.9708929,0.9749404,0.9828236,0.9925515,0.9974833,0.9989650,0.9992378,0.9992337,0.9991788,0.9991097,0.9990342,0.9989522,0.9988638,1]
ax1[0][0].plot(fitW, fitF, c=modelColour)
wvl, flx = pyasl.read1dFitsSpec('/home/nwal/Desktop/toEmail/41/nightSide/NLTT5306C.fits')
ax1[0][0].plot(wvl, flx, c=dataColour)
ax1[0][0].set_xlim(rightxlim1,rightxlim2)
ax1[0][0].set_ylim(leftylim1,leftylim2)

wavel = [5869.000,5869.200,5869.400,5869.600,5869.800,5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000,5920.200,5920.400,5920.600,5920.800,5921.000]
flux = [1.023200,1.016020,0.9928210,0.9924852,0.9944823,0.9993722,1.008798,1.009385,1.007879,0.9990013,1.009175,1.008254,1.013240,0.9972250,1.015678,1.017718,0.9871446,0.9946810,1.011275,1.014339,1.003128,0.9948620,0.9899877,0.9892387,1.007261,1.015097,1.008809,1.000659,0.9841820,0.9903297,0.9895987,0.9886690,0.9920514,1.000020,0.9931806,0.9848154,0.9874117,0.9980849,0.9923726,0.9993616,0.9993599,1.004690,1.003061,1.000165,0.9981720,1.005492,1.001427,0.9823727,0.9935668,0.9992609,0.9839785,0.9762499,0.9810930,0.9911101,1.003678,0.9912760,0.9895861,1.011399,0.9992270,0.9816790,0.9898226,0.9822191,0.9927329,0.9901053,0.9967520,0.9860957,0.9968774,1.007013,0.9963775,0.9933270,0.9895307,0.9743288,0.9828507,0.9994944,0.9840320,0.9918051,1.003715,0.9836618,0.9849723,1.011548,0.9926383,0.9899377,1.006894,0.9950914,0.9899244,0.9979694,0.9952212,0.9767537,0.9825153,0.9800392,0.9877430,0.9985970,1.004815,0.9821207,0.9797906,0.9911626,0.9994180,1.001410,0.9899040,0.9834533,1.000872,0.9874609,0.9580503,0.9123570,0.8875186,0.8585857,0.8834670,0.9339564,0.9522998,0.9736223,0.9874728,0.9859153,0.9828740,0.9758166,0.9958082,0.9840965,0.9771628,1.004888,0.9966871,0.9822790,0.9928515,0.9795340,0.9789856,0.9875871,0.9716306,0.9804037,0.9934068,0.9947881,0.9880950,0.9794731,1.010117,1.009221,0.9828268,0.9652718,0.9375913,0.9146019,0.9232371,0.9547569,1.001767,1.011900,1.011906,0.9862813,0.9656574,0.9716412,0.9684007,0.9848529,0.9908977,0.9832408,1.005335,0.9915286,0.9808238,0.9965624,0.9904513,0.9754335,0.9763332,0.9862698,0.9768756,0.9939442,0.9908774,0.9763355,0.9670727,0.9826393,0.9945170,0.9813762,0.9776348,0.9822999,0.9851844,0.9834989,0.9895779,0.9845910,1.001749,1.015529,0.9779943,0.9679135,0.9831631,0.9810906,1.006770,1.058921,1.032569,0.9959034,0.9819713,0.9863108,0.9822666,0.9845377,0.9833552,0.9871659,1.000012,1.004108,0.9730495,0.9848935,0.9886814,0.9953238,0.9993830,0.9894000,0.9867238,0.9840831,0.9770018,0.9972946,0.9976665,0.9906497,0.9951597,0.9843717,0.9892933,0.9894263,0.9755899,0.9720669,0.9790577,0.9861763,0.9877816,0.9913125,0.9785177,0.9674231,0.9626499,0.9832882,0.9824040,0.9740483,0.9852749,0.9817554,0.9731703,0.9718674,0.9822289,0.9916204,0.9786855,0.9702768,0.9906635,0.9715106,0.9767117,1.000630,0.9891734,0.9886160,0.9849252,0.9807577,0.9974331,0.9674026,0.9746315,0.9682573,0.9718102,0.9842622,0.9818008,0.9854606,0.9893956,0.9699342,0.9775665,0.9691575,0.9621202,0.9772291,0.9727452,0.9680300,0.9774653,0.9701455,0.9642038,0.9653072,0.9595559,0.9614112,0.9685156,0.9707047,0.9684294,0.9545666,0.9585325,0.9869414,0.9944150]
fitW = [5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000]
fitF = [1.000537,1.000445,1.000355,1.000267,1.000178,1.000088,0.9999999,0.9999161,0.9998338,0.9997483,0.9996571,0.9995623,0.9994672,0.9993730,0.9992812,0.9991920,0.9991040,0.9990149,0.9989233,0.9988313,0.9987410,0.9986551,0.9985725,0.9984880,0.9983993,0.9983071,0.9982135,0.9981207,0.9980299,0.9979420,0.9978542,0.9977632,0.9976704,0.9975761,0.9974813,0.9973876,0.9972975,0.9972125,0.9971293,0.9970431,0.9969525,0.9968605,0.9967704,0.9966822,0.9965938,0.9965031,0.9964105,0.9963176,0.9962246,0.9961324,0.9960405,0.9959482,0.9958552,0.9957608,0.9956660,0.9955711,0.9954771,0.9953852,0.9952955,0.9952080,0.9951200,0.9950302,0.9949387,0.9948457,0.9947526,0.9946595,0.9945670,0.9944745,0.9943810,0.9942876,0.9941944,0.9941018,0.9940088,0.9939127,0.9938126,0.9937103,0.9936102,0.9935117,0.9934109,0.9933071,0.9932007,0.9930912,0.9929773,0.9928579,0.9927340,0.9926039,0.9924656,0.9923155,0.9921469,0.9919531,0.9917214,0.9914322,0.9910493,0.9904905,0.9895371,0.9873616,0.9808899,0.9624258,0.9247022,0.8817345,0.8696122,0.9008234,0.9447934,0.9729136,0.9841397,0.9877087,0.9889255,0.9894555,0.9897271,0.9898688,0.9899358,0.9899556,0.9899433,0.9899081,0.9898564,0.9897901,0.9897098,0.9896173,0.9895121,0.9893908,0.9892460,0.9890670,0.9888352,0.9885045,0.9879357,0.9865357,0.9819555,0.9683763,0.9412708,0.9131592,0.9091936,0.9333404,0.9625571,0.9792132,0.9851294,0.9868012,0.9873184,0.9875236,0.9876116,0.9876395,0.9876326,0.9876035,0.9875589,0.9875031,0.9874408,0.9873742,0.9873032,0.9872283,0.9871517,0.9870749,0.9869968,0.9869158,0.9868305,0.9867432,0.9866579,0.9865750,0.9864918,0.9864071,0.9863213,0.9862370,0.9861535,0.9860675,0.9859769,0.9858826,0.9857884,0.9856972,0.9856127,0.9855341,0.9854543,0.9853690,0.9852781,0.9851846,0.9850901,0.9849958,0.9849043,0.9848171,0.9847330,0.9846482,0.9845603,0.9844719,0.9843838,0.9842944,0.9842032,0.9841101,0.9840167,0.9839245,0.9838362,0.9837523,0.9836680,0.9835801,0.9834883,0.9833959,0.9833056,0.9832163,0.9831262,0.9830338,0.9829410,0.9828503,0.9827635,0.9826809,0.9825974,0.9825095,0.9824174,0.9823226,0.9822273,0.9821337,0.9820437,0.9819558,0.9818665,0.9817757,0.9816853,0.9815986,0.9815157,0.9814314,0.9813424,0.9812490,0.9811544,0.9810603,0.9809664,0.9808739,0.9807839,0.9806958,0.9806076,0.9805179,0.9804295,0.9803438,0.9802591,0.9801717,0.9800807,0.9799882,0.9798951,0.9798017,0.9797083,0.9796150,0.9795235,0.9794342,0.9793457,0.9792563,0.9791666,0.9790800,0.9789960,0.9789105,0.9788214,0.9787291,0.9786358,0.9785421,0.9784485,0.9783550,0.9782621,0.9781714,0.9715352]
cont = -0.00044731199999998114*np.array(wavel) + 3.626258439999889
flux = (np.array(flux))/np.array(cont)
cont = -0.00044731199999998114*np.array(fitW) + 3.626258439999889
fitF = np.array(fitF)/np.array(cont)

ax1[0][1].plot(wavel, flux, c=dataColour)
ax1[0][1].plot(fitW, fitF, c=modelColour)
#guess = 140

ax1[0][1].set_xlim(5885.001,5900-0.00001)
ax1[0][1].set_ylim(leftylim1,leftylim2)


#GD1400
wavel = [3929.010,3929.038,3929.065,3929.092,3929.120,3929.147,3929.174,3929.201,3929.229,3929.256,3929.283,3929.310,3929.337,3929.365,3929.392,3929.419,3929.447,3929.474,3929.501,3929.528,3929.555,3929.583,3929.610,3929.637,3929.664,3929.692,3929.719,3929.746,3929.773,3929.801,3929.828,3929.855,3929.882,3929.910,3929.937,3929.964,3929.991,3930.019,3930.046,3930.073,3930.100,3930.127,3930.155,3930.182,3930.209,3930.237,3930.264,3930.291,3930.318,3930.345,3930.373,3930.400,3930.427,3930.454,3930.482,3930.509,3930.536,3930.563,3930.591,3930.618,3930.645,3930.672,3930.700,3930.727,3930.754,3930.781,3930.809,3930.836,3930.863,3930.890,3930.917,3930.945,3930.972,3930.999,3931.027,3931.054,3931.081,3931.108,3931.135,3931.163,3931.190,3931.217,3931.244,3931.272,3931.299,3931.326,3931.354,3931.381,3931.408,3931.435,3931.462,3931.490,3931.517,3931.544,3931.571,3931.599,3931.626,3931.653,3931.680,3931.708,3931.735,3931.762,3931.789,3931.817,3931.844,3931.871,3931.898,3931.926,3931.953,3931.980,3932.007,3932.034,3932.062,3932.089,3932.116,3932.144,3932.171,3932.198,3932.225,3932.252,3932.280,3932.307,3932.334,3932.361,3932.389,3932.416,3932.443,3932.470,3932.498,3932.525,3932.552,3932.579,3932.607,3932.634,3932.661,3932.688,3932.716,3932.743,3932.770,3932.797,3932.824,3932.852,3932.879,3932.906,3932.934,3932.961,3932.988,3933.015,3933.042,3933.070,3933.097,3933.124,3933.151,3933.179,3933.206,3933.233,3933.260,3933.288,3933.315,3933.342,3933.369,3933.396,3933.424,3933.451,3933.478,3933.506,3933.533,3933.560,3933.587,3933.615,3933.642,3933.669,3933.696,3933.723,3933.751,3933.778,3933.805,3933.833,3933.860,3933.887,3933.914,3933.941,3933.969,3933.996,3934.023,3934.051,3934.078,3934.105,3934.132,3934.159,3934.187,3934.214,3934.241,3934.268,3934.296,3934.323,3934.350,3934.377,3934.405,3934.432,3934.459,3934.486,3934.513,3934.541,3934.568,3934.595,3934.623,3934.650,3934.677,3934.704,3934.731,3934.759,3934.786,3934.813,3934.840,3934.868,3934.895,3934.922,3934.949,3934.977,3935.004,3935.031,3935.058,3935.086,3935.113,3935.140,3935.167,3935.195,3935.222,3935.249,3935.276,3935.303,3935.331,3935.358,3935.385,3935.413,3935.440,3935.467,3935.494,3935.521,3935.549,3935.576,3935.603,3935.630,3935.658,3935.685,3935.712,3935.740,3935.767,3935.794,3935.821,3935.848,3935.876,3935.903,3935.930,3935.957,3935.985,3936.012,3936.039,3936.066,3936.094,3936.121,3936.148,3936.175,3936.203,3936.230,3936.257,3936.284,3936.312,3936.339,3936.366,3936.393,3936.420,3936.448,3936.475,3936.502,3936.530,3936.557,3936.584,3936.611,3936.638,3936.666,3936.693,3936.720,3936.747,3936.775,3936.802,3936.829,3936.856,3936.884,3936.911,3936.938,3936.965,3936.993]
flux = [1.008063,0.9913183,0.9803799,0.9858985,0.9831511,0.9923878,0.9852846,0.9778347,1.008726,1.022313,0.9884639,0.9913952,1.025754,1.002149,0.9773104,0.9957785,1.004747,0.9969833,0.9929450,0.9947072,1.007510,1.025029,1.010613,1.001528,1.000886,0.9784724,0.9662622,0.9837988,1.007912,1.009268,0.9870530,0.9999321,1.012859,0.9869104,0.9657051,0.9943402,1.032219,1.016212,0.9853404,0.9949394,1.007992,0.9884035,0.9850742,1.005068,1.022886,1.011631,0.9945387,0.9932204,0.9899487,0.9935498,1.002429,1.008350,1.019396,1.017297,0.9865527,0.9706894,0.9869213,0.9971361,0.9975295,0.9913156,0.9692539,0.9829279,1.005700,1.008420,0.9938846,0.9864731,0.9891958,1.006101,1.002694,0.9812051,0.9820797,0.9971627,1.012195,1.017818,1.007468,0.9886908,0.9858574,0.9956860,1.020108,1.030924,1.014371,1.009658,1.007563,1.004174,1.009248,1.004298,1.007576,0.9980556,0.9876021,1.007370,1.009585,0.9897420,0.9844942,1.012709,1.004867,1.009128,1.021387,1.004084,1.007347,1.001773,0.9970958,1.024111,1.023250,0.9992687,1.007742,1.012879,0.9998149,0.9981444,1.000654,0.9976082,1.002746,1.017102,1.015830,0.9932231,0.9693829,0.9766957,1.009817,1.010093,0.9899213,1.002496,1.023823,1.024901,1.009856,0.9978790,0.9968818,0.9923650,0.9856277,0.9900348,0.9993557,0.9947950,0.9814888,0.9744761,0.9842874,1.001281,1.008097,1.025125,1.021256,0.9977217,0.9958892,1.003146,1.016734,1.020927,1.005736,1.004365,1.012083,1.008282,1.007645,0.9925854,0.9973639,1.006896,1.006116,1.011179,0.9952158,0.9733618,0.9666675,0.9444137,0.9604436,0.9853277,0.9962496,1.000514,0.9698212,0.9474786,0.9662036,0.9723974,0.9674287,0.9816260,0.9987034,0.9779316,0.9742574,0.9872398,0.9762684,0.9648643,0.9869259,1.007483,0.9916404,0.9817285,0.9838657,0.9858931,0.9995230,1.012268,1.001084,0.9915105,1.020400,1.012311,0.9923100,0.9911427,1.000555,1.016374,1.020378,1.019423,1.021528,1.013617,1.001062,0.9962807,0.9954280,0.9889122,0.9908764,0.9957894,1.008275,1.016822,0.9973823,0.9852425,0.9843569,0.9807020,0.9776691,0.9710993,0.9830056,0.9882215,0.9695558,0.9712365,0.9920164,0.9985725,0.9863477,0.9900796,0.9877145,0.9865956,1.017531,1.037463,1.031757,1.015925,1.008107,0.9905316,0.9848793,0.9975743,1.012484,1.008172,0.9900814,0.9897932,0.9915965,0.9953255,1.008401,1.008066,1.002049,0.9927932,0.9887365,0.9915316,0.9819745,0.9854905,0.9910640,0.9914244,1.012365,1.009161,0.9861391,0.9860357,0.9939569,0.9968415,0.9950282,0.9901034,1.003085,1.018316,1.010579,0.9977583,1.000841,0.9951856,0.9780744,0.9885434,1.002687,0.9924884,0.9778703,0.9897255,0.9987683,0.9927978,0.9914885,0.9862114,0.9856579,0.9978561,1.002410,1.000608,1.004093,0.9964206,0.9908728,0.9878006,0.9794147,0.9844741,0.9823433,0.9917446,1.011294,1.004668,0.9973859,0.9850330,0.9748924,0.9883193,0.9959092,0.9920356,0.9925268,0.9972945,0.9835564,0.9787532,0.9840898,0.9691075,0.9605103,0.9635377,0.9559834,0.9710453]
fitW = [3929,3930.019,3930.046,3930.073,3930.100,3930.127,3930.155,3930.182,3930.209,3930.237,3930.264,3930.291,3930.318,3930.345,3930.373,3930.400,3930.427,3930.454,3930.482,3930.509,3930.536,3930.563,3930.591,3930.618,3930.645,3930.672,3930.700,3930.727,3930.754,3930.781,3930.809,3930.836,3930.863,3930.890,3930.917,3930.945,3930.972,3930.999,3931.027,3931.054,3931.081,3931.108,3931.135,3931.163,3931.190,3931.217,3931.244,3931.272,3931.299,3931.326,3931.354,3931.381,3931.408,3931.435,3931.462,3931.490,3931.517,3931.544,3931.571,3931.599,3931.626,3931.653,3931.680,3931.708,3931.735,3931.762,3931.789,3931.817,3931.844,3931.871,3931.898,3931.926,3931.953,3931.980,3932.007,3932.034,3932.062,3932.089,3932.116,3932.144,3932.171,3932.198,3932.225,3932.252,3932.280,3932.307,3932.334,3932.361,3932.389,3932.416,3932.443,3932.470,3932.498,3932.525,3932.552,3932.579,3932.607,3932.634,3932.661,3932.688,3932.716,3932.743,3932.770,3932.797,3932.824,3932.852,3932.879,3932.906,3932.934,3932.961,3932.988,3933.015,3933.042,3933.070,3933.097,3933.124,3933.151,3933.179,3933.206,3933.233,3933.260,3933.288,3933.315,3933.342,3933.369,3933.396,3933.424,3933.451,3933.478,3933.506,3933.533,3933.560,3933.587,3933.615,3933.642,3933.669,3933.696,3933.723,3933.751,3933.778,3933.805,3933.833,3933.860,3933.887,3933.914,3933.941,3933.969,3933.996,3934.023,3934.051,3934.078,3934.105,3934.132,3934.159,3934.187,3934.214,3934.241,3934.268,3934.296,3934.323,3934.350,3934.377,3934.405,3934.432,3934.459,3934.486,3934.513,3934.541,3934.568,3934.595,3934.623,3934.650,3934.677,3934.704,3934.731,3934.759,3934.786,3934.813,3934.840,3934.868,3934.895,3934.922,3934.949,3934.977,3935.004,3935.031,3935.058,3935.086,3935.113,3935.140,3935.167,3935.195,3935.222,3935.249,3935.276,3935.303,3935.331,3935.358,3935.385,3935.413,3935.440,3935.467,3935.494,3935.521,3935.549,3935.576,3935.603,3935.630,3935.658,3935.685,3935.712,3935.740,3935.767,3935.794,3935.821,3935.848,3935.876,3935.903,3935.930,3935.957,3935.985,3937]
fitF = [1,0.9997256,0.9997389,0.9997522,0.9997655,0.9997776,0.9997895,0.9998011,0.9998123,0.9998230,0.9998336,0.9998437,0.9998533,0.9998624,0.9998710,0.9998794,0.9998869,0.9998942,0.9999013,0.9999084,0.9999155,0.9999226,0.9999296,0.9999366,0.9999436,0.9999502,0.9999567,0.9999617,0.9999666,0.9999701,0.9999736,0.9999772,0.9999807,0.9999842,0.9999874,0.9999903,0.9999928,0.9999953,0.9999965,0.9999975,0.9999972,0.9999970,0.9999969,0.9999974,0.9999985,0.9999993,1.000000,0.9999990,0.9999976,0.9999944,0.9999910,0.9999871,0.9999832,0.9999793,0.9999755,0.9999718,0.9999677,0.9999632,0.9999580,0.9999526,0.9999474,0.9999422,0.9999366,0.9999307,0.9999236,0.9999163,0.9999082,0.9999001,0.9998920,0.9998836,0.9998752,0.9998664,0.9998574,0.9998477,0.9998377,0.9998270,0.9998159,0.9998043,0.9997920,0.9997794,0.9997665,0.9997532,0.9997395,0.9997257,0.9997119,0.9996982,0.9996842,0.9996700,0.9996552,0.9996400,0.9996244,0.9996076,0.9995906,0.9995728,0.9995552,0.9995376,0.9995199,0.9995019,0.9994833,0.9994645,0.9994449,0.9994252,0.9994044,0.9993833,0.9993610,0.9993383,0.9993150,0.9992915,0.9992678,0.9992439,0.9992193,0.9991940,0.9991677,0.9991402,0.9991119,0.9990820,0.9990520,0.9990208,0.9989891,0.9989547,0.9989175,0.9988765,0.9988292,0.9987775,0.9987102,0.9986373,0.9985076,0.9983534,0.9978514,0.9968917,0.9942028,0.9891915,0.9802004,0.9702355,0.9595453,0.9562250,0.9635126,0.9742334,0.9852365,0.9908994,0.9956743,0.9968690,0.9977027,0.9978914,0.9979997,0.9980352,0.9980455,0.9980442,0.9980299,0.9980133,0.9979900,0.9979657,0.9979380,0.9979089,0.9978782,0.9978465,0.9978141,0.9977807,0.9977463,0.9977101,0.9976731,0.9976340,0.9975950,0.9975548,0.9975152,0.9974756,0.9974362,0.9973964,0.9973552,0.9973137,0.9972708,0.9972279,0.9971846,0.9971412,0.9970970,0.9970520,0.9970062,0.9969597,0.9969134,0.9968665,0.9968197,0.9967734,0.9967267,0.9966801,0.9966329,0.9965847,0.9965363,0.9964863,0.9964363,0.9963853,0.9963347,0.9962835,0.9962321,0.9961811,0.9961288,0.9960769,0.9960237,0.9959704,0.9959173,0.9958634,0.9958096,0.9957547,0.9957000,0.9956442,0.9955882,0.9955317,0.9954745,0.9954170,0.9953588,0.9953005,0.9952425,0.9951838,0.9951254,0.9950663,0.9950072,0.9949474,0.9948860,0.9948251,0.9947635,0.9947023,0.9946408,0.9946408]
cont = -0.0008522963459602814*np.array(fitW) + 4.349266433254476
fitF = np.array(fitF)/np.array(cont)
ax1[1][0].plot(fitW, fitF, c=modelColour)
cont = -0.0008522963459602814*np.array(wavel) + 4.349266433254476
flux = np.array(flux)/np.array(cont)
#wvl, flx = pyasl.read1dFitsSpec('/home/nwal/Desktop/toEmail/41/nightSide/NLTT5306C.fits')
ax1[1][0].plot(wavel, flux, c=dataColour)
ax1[1][0].set_xlim(rightxlim1,rightxlim2)
ax1[1][0].set_ylim(leftylim1,leftylim2)
wvl, flx = pyasl.read1dFitsSpec('/home/nwal/Desktop/GD1400/reflexFin/sodium/night/coAddShifted.fits')
wavel = wvl
flux = flx/28.4
fitW = [5880.000,5880.030,5880.060,5880.090,5880.120,5880.140,5880.170,5880.200,5880.230,5880.260,5880.290,5880.310,5880.340,5880.370,5880.400,5880.430,5880.460,5880.480,5880.510,5880.540,5880.570,5880.600,5880.630,5880.650,5880.680,5880.710,5880.740,5880.770,5880.800,5880.820,5880.850,5880.880,5880.910,5880.940,5880.970,5880.990,5881.020,5881.050,5881.080,5881.110,5881.140,5881.160,5881.190,5881.220,5881.250,5881.280,5881.310,5881.330,5881.360,5881.390,5881.420,5881.450,5881.480,5881.500,5881.530,5881.560,5881.590,5881.620,5881.650,5881.670,5881.700,5881.730,5881.760,5881.790,5881.820,5881.840,5881.870,5881.900,5881.930,5881.960,5881.990,5882.010,5882.040,5882.070,5882.100,5882.130,5882.160,5882.180,5882.210,5882.240,5882.270,5882.300,5882.320,5882.350,5882.380,5882.410,5882.440,5882.470,5882.490,5882.520,5882.550,5882.580,5882.610,5882.640,5882.660,5882.690,5882.720,5882.750,5882.780,5882.810,5882.830,5882.860,5882.890,5882.920,5882.950,5882.980,5883.000,5883.030,5883.060,5883.090,5883.120,5883.150,5883.170,5883.200,5883.230,5883.260,5883.290,5883.320,5883.340,5883.370,5883.400,5883.430,5883.460,5883.490,5883.510,5883.540,5883.570,5883.600,5883.630,5883.660,5883.680,5883.710,5883.740,5883.770,5883.800,5883.830,5883.850,5883.880,5883.910,5883.940,5883.970,5884.000,5884.020,5884.050,5884.080,5884.110,5884.140,5884.170,5884.190,5884.220,5884.250,5884.280,5884.310,5884.340,5884.360,5884.390,5884.420,5884.450,5884.480,5884.510,5884.530,5884.560,5884.590,5884.620,5884.650,5884.680,5884.700,5884.730,5884.760,5884.790,5884.820,5884.840,5884.870,5884.900,5884.930,5884.960,5884.990,5885.010,5885.040,5885.070,5885.100,5885.130,5885.160,5885.180,5885.210,5885.240,5885.270,5885.300,5885.330,5885.350,5885.380,5885.410,5885.440,5885.470,5885.500,5885.520,5885.550,5885.580,5885.610,5885.640,5885.670,5885.690,5885.720,5885.750,5885.780,5885.810,5885.840,5885.860,5885.890,5885.920,5885.950,5885.980,5886.010,5886.030,5886.060,5886.090,5886.120,5886.150,5886.180,5886.200,5886.230,5886.260,5886.290,5886.320,5886.350,5886.370,5886.400,5886.430,5886.460,5886.490,5886.520,5886.540,5886.570,5886.600,5886.630,5886.660,5886.690,5886.710,5886.740,5886.770,5886.800,5886.830,5886.860,5886.880,5886.910,5886.940,5886.970,5887.000,5887.030,5887.050,5887.080,5887.110,5887.140,5887.170,5887.200,5887.220,5887.250,5887.280,5887.310,5887.340,5887.360,5887.390,5887.420,5887.450,5887.480,5887.510,5887.530,5887.560,5887.590,5887.620,5887.650,5887.680,5887.700,5887.730,5887.760,5887.790,5887.820,5887.850,5887.870,5887.900,5887.930,5887.960,5887.990,5888.020,5888.040,5888.070,5888.100,5888.130,5888.160,5888.190,5888.210,5888.240,5888.270,5888.300,5888.330,5888.360,5888.380,5888.410,5888.440,5888.470,5888.500,5888.530,5888.550,5888.580,5888.610,5888.640,5888.670,5888.700,5888.720,5888.750,5888.780,5888.810,5888.840,5888.870,5888.890,5888.920,5888.950,5888.980,5889.010,5889.040,5889.060,5889.090,5889.120,5889.150,5889.180,5889.210,5889.230,5889.260,5889.290,5889.320,5889.350,5889.380,5889.400,5889.430,5889.460,5889.490,5889.520,5889.550,5889.570,5889.600,5889.630,5889.660,5889.690,5889.720,5889.740,5889.770,5889.800,5889.830,5889.860,5889.890,5889.910,5889.940,5889.970,5890.000,5890.030,5890.050,5890.080,5890.110,5890.140,5890.170,5890.200,5890.220,5890.250,5890.280,5890.310,5890.340,5890.370,5890.390,5890.420,5890.450,5890.480,5890.510,5890.540,5890.560,5890.590,5890.620,5890.650,5890.680,5890.710,5890.730,5890.760,5890.790,5890.820,5890.850,5890.880,5890.900,5890.930,5890.960,5890.990,5891.020,5891.050,5891.070,5891.100,5891.130,5891.160,5891.190,5891.220,5891.240,5891.270,5891.300,5891.330,5891.360,5891.390,5891.410,5891.440,5891.470,5891.500,5891.530,5891.560,5891.580,5891.610,5891.640,5891.670,5891.700,5891.730,5891.750,5891.780,5891.810,5891.840,5891.870,5891.900,5891.920,5891.950,5891.980,5892.010,5892.040,5892.070,5892.090,5892.120,5892.150,5892.180,5892.210,5892.240,5892.260,5892.290,5892.320,5892.350,5892.380,5892.410,5892.430,5892.460,5892.490,5892.520,5892.550,5892.570,5892.600,5892.630,5892.660,5892.690,5892.720,5892.740,5892.770,5892.800,5892.830,5892.860,5892.890,5892.910,5892.940,5892.970,5893.000,5893.030,5893.060,5893.080,5893.110,5893.140,5893.170,5893.200,5893.230,5893.250,5893.280,5893.310,5893.340,5893.370,5893.400,5893.420,5893.450,5893.480,5893.510,5893.540,5893.570,5893.590,5893.620,5893.650,5893.680,5893.710,5893.740,5893.760,5893.790,5893.820,5893.850,5893.880,5893.910,5893.930,5893.960,5893.990,5894.020,5894.050,5894.080,5894.100,5894.130,5894.160,5894.190,5894.220,5894.250,5894.270,5894.300,5894.330,5894.360,5894.390,5894.420,5894.440,5894.470,5894.500,5894.530,5894.560,5894.590,5894.610,5894.640,5894.670,5894.700,5894.730,5894.760,5894.780,5894.810,5894.840,5894.870,5894.900,5894.930,5894.950,5894.980,5895.010,5895.040,5895.070,5895.090,5895.120,5895.150,5895.180,5895.210,5895.240,5895.260,5895.290,5895.320,5895.350,5895.380,5895.410,5895.430,5895.460,5895.490,5895.520,5895.550,5895.580,5895.600,5895.630,5895.660,5895.690,5895.720,5895.750,5895.770,5895.800,5895.830,5895.860,5895.890,5895.920,5895.940,5895.970,5896.000,5896.030,5896.060,5896.090,5896.110,5896.140,5896.170,5896.200,5896.230,5896.260,5896.280,5896.310,5896.340,5896.370,5896.400,5896.430,5896.450,5896.480,5896.510,5896.540,5896.570,5896.600,5896.620,5896.650,5896.680,5896.710,5896.740,5896.770,5896.790,5896.820,5896.850,5896.880,5896.910,5896.940,5896.960,5896.990,5897.020,5897.050,5897.080,5897.110,5897.130,5897.160,5897.190,5897.220,5897.250,5897.280,5897.300,5897.330,5897.360,5897.390,5897.420,5897.450,5897.470,5897.500,5897.530,5897.560,5897.590,5897.620,5897.640,5897.670,5897.700,5897.730,5897.760,5897.780,5897.810,5897.840,5897.870,5897.900,5897.930,5897.950,5897.980,5898.010,5898.040,5898.070,5898.100,5898.120,5898.150,5898.180,5898.210,5898.240,5898.270,5898.290,5898.320,5898.350,5898.380,5898.410,5898.440,5898.460,5898.490,5898.520,5898.550,5898.580,5898.610,5898.630,5898.660,5898.690,5898.720,5898.750,5898.780,5898.800,5898.830,5898.860,5898.890,5898.920,5898.950,5898.970,5899.000,5899.030,5899.060,5899.090,5899.120,5899.140,5899.170,5899.200,5899.230,5899.260,5899.290,5899.310,5899.340,5899.370,5899.400,5899.430,5899.460,5899.480,5899.510,5899.540,5899.570,5899.600,5899.630,5899.650,5899.680,5899.710,5899.740,5899.770,5899.800,5899.820,5899.850,5899.880,5899.910,5899.940,5899.970,5899.990,5900.020,5900.050,5900.080,5900.110,5900.140,5900.160,5900.190,5900.220,5900.250,5900.280,5900.300,5900.330,5900.360,5900.390,5900.420,5900.450,5900.470,5900.500,5900.530,5900.560,5900.590,5900.620,5900.640,5900.670,5900.700,5900.730,5900.760,5900.790,5900.810,5900.840,5900.870,5900.900,5900.930,5900.960,5900.980,5901.010,5901.040,5901.070,5901.100,5901.130,5901.150,5901.180,5901.210,5901.240,5901.270,5901.300,5901.320,5901.350,5901.380,5901.410,5901.440,5901.470,5901.490,5901.520,5901.550,5901.580,5901.610,5901.640,5901.660,5901.690,5901.720,5901.750,5901.780,5901.810,5901.830,5901.860,5901.890,5901.920,5901.950,5901.980,5902.000,5902.030,5902.060,5902.090,5902.120,5902.150,5902.170,5902.200,5902.230,5902.260,5902.290,5902.320,5902.340,5902.370,5902.400,5902.430,5902.460,5902.490,5902.510,5902.540,5902.570,5902.600,5902.630,5902.660,5902.680,5902.710,5902.740,5902.770,5902.800,5902.820,5902.850,5902.880,5902.910,5902.940,5902.970,5902.990,5903.020,5903.050,5903.080,5903.110,5903.140,5903.160,5903.190,5903.220,5903.250,5903.280,5903.310,5903.330,5903.360,5903.390,5903.420,5903.450,5903.480,5903.500,5903.530,5903.560,5903.590,5903.620,5903.650,5903.670,5903.700,5903.730,5903.760,5903.790,5903.820,5903.840,5903.870,5903.900,5903.930,5903.960,5903.990,5904.010,5904.040,5904.070,5904.100,5904.130,5904.160,5904.180,5904.210,5904.240,5904.270,5904.300,5904.330,5904.350,5904.380,5904.410,5904.440,5904.470,5904.500,5904.520,5904.550,5904.580,5904.610,5904.640,5904.670,5904.690,5904.720,5904.750,5904.780,5904.810,5904.840,5904.860,5904.890,5904.920,5904.950,5904.980,5905.010,5905.030,5905.060,5905.090,5905.120,5905.150,5905.180,5905.200,5905.230,5905.260,5905.290,5905.320,5905.350,5905.370,5905.400,5905.430,5905.460,5905.490,5905.510,5905.540,5905.570,5905.600,5905.630,5905.660,5905.680,5905.710,5905.740,5905.770,5905.800,5905.830,5905.850,5905.880,5905.910,5905.940,5905.970,5906.000,5906.020,5906.050,5906.080,5906.110,5906.140,5906.170,5906.190,5906.220,5906.250,5906.280,5906.310,5906.340,5906.360,5906.390,5906.420,5906.450,5906.480,5906.510,5906.530,5906.560,5906.590,5906.620,5906.650,5906.680,5906.700,5906.730,5906.760,5906.790,5906.820,5906.850,5906.870,5906.900,5906.930,5906.960,5906.990,5907.020,5907.040,5907.070,5907.100,5907.130,5907.160,5907.190,5907.210,5907.240,5907.270,5907.300,5907.330,5907.360,5907.380,5907.410,5907.440,5907.470,5907.500,5907.530,5907.550,5907.580,5907.610,5907.640,5907.670,5907.700,5907.720,5907.750,5907.780,5907.810,5907.840,5907.870,5907.890,5907.920,5907.950,5907.980,5908.010,5908.030,5908.060,5908.090,5908.120,5908.150,5908.180,5908.200,5908.230,5908.260,5908.290,5908.320,5908.350,5908.370,5908.400,5908.430,5908.460,5908.490,5908.520,5908.540,5908.570,5908.600,5908.630,5908.660,5908.690,5908.710,5908.740,5908.770,5908.800,5908.830,5908.860,5908.880,5908.910,5908.940,5908.970,5909.000,5909.030,5909.050,5909.080,5909.110,5909.140,5909.170,5909.200,5909.220,5909.250,5909.280,5909.310,5909.340,5909.370,5909.390,5909.420,5909.450,5909.480,5909.510,5909.540,5909.560,5909.590,5909.620,5909.650,5909.680,5909.710,5909.730,5909.760,5909.790,5909.820,5909.850,5909.880,5909.900,5909.930,5909.960,5909.990]
fitF = [1.000473,1.000458,1.000444,1.000430,1.000415,1.000405,1.000391,1.000377,1.000363,1.000350,1.000336,1.000327,1.000313,1.000299,1.000286,1.000272,1.000258,1.000249,1.000236,1.000222,1.000209,1.000195,1.000181,1.000172,1.000158,1.000144,1.000131,1.000117,1.000103,1.000094,1.000080,1.000066,1.000052,1.000038,1.000023,1.000014,1.000000,0.9999861,0.9999720,0.9999583,0.9999442,0.9999349,0.9999208,0.9999064,0.9998921,0.9998778,0.9998634,0.9998540,0.9998401,0.9998261,0.9998125,0.9997987,0.9997852,0.9997761,0.9997625,0.9997487,0.9997351,0.9997213,0.9997078,0.9996986,0.9996848,0.9996712,0.9996576,0.9996438,0.9996302,0.9996211,0.9996073,0.9995936,0.9995797,0.9995660,0.9995520,0.9995430,0.9995288,0.9995147,0.9995003,0.9994863,0.9994720,0.9994627,0.9994489,0.9994350,0.9994212,0.9994075,0.9993981,0.9993837,0.9993694,0.9993548,0.9993404,0.9993261,0.9993166,0.9993028,0.9992891,0.9992753,0.9992618,0.9992480,0.9992388,0.9992253,0.9992115,0.9991978,0.9991843,0.9991704,0.9991613,0.9991477,0.9991339,0.9991203,0.9991065,0.9990931,0.9990839,0.9990703,0.9990564,0.9990426,0.9990283,0.9990142,0.9990047,0.9989904,0.9989765,0.9989625,0.9989485,0.9989346,0.9989253,0.9989110,0.9988968,0.9988822,0.9988678,0.9988531,0.9988438,0.9988295,0.9988157,0.9988016,0.9987881,0.9987745,0.9987654,0.9987520,0.9987384,0.9987249,0.9987115,0.9986978,0.9986887,0.9986751,0.9986613,0.9986477,0.9986337,0.9986200,0.9986106,0.9985967,0.9985823,0.9985682,0.9985538,0.9985398,0.9985304,0.9985164,0.9985027,0.9984890,0.9984752,0.9984617,0.9984526,0.9984389,0.9984254,0.9984117,0.9983979,0.9983840,0.9983746,0.9983601,0.9983457,0.9983310,0.9983166,0.9983023,0.9982929,0.9982791,0.9982654,0.9982517,0.9982383,0.9982291,0.9982153,0.9982015,0.9981872,0.9981732,0.9981589,0.9981497,0.9981354,0.9981216,0.9981077,0.9980940,0.9980801,0.9980710,0.9980575,0.9980437,0.9980302,0.9980168,0.9980031,0.9979940,0.9979805,0.9979668,0.9979531,0.9979393,0.9979256,0.9979163,0.9979024,0.9978878,0.9978735,0.9978585,0.9978437,0.9978337,0.9978188,0.9978042,0.9977902,0.9977760,0.9977623,0.9977531,0.9977394,0.9977259,0.9977123,0.9976990,0.9976856,0.9976766,0.9976629,0.9976494,0.9976356,0.9976220,0.9976081,0.9975989,0.9975852,0.9975713,0.9975572,0.9975432,0.9975289,0.9975193,0.9975051,0.9974905,0.9974762,0.9974614,0.9974471,0.9974374,0.9974232,0.9974089,0.9973951,0.9973811,0.9973674,0.9973581,0.9973440,0.9973300,0.9973160,0.9973017,0.9972878,0.9972785,0.9972646,0.9972510,0.9972373,0.9972239,0.9972103,0.9972013,0.9971873,0.9971733,0.9971588,0.9971444,0.9971296,0.9971197,0.9971049,0.9970903,0.9970755,0.9970611,0.9970515,0.9970371,0.9970230,0.9970087,0.9969949,0.9969810,0.9969718,0.9969578,0.9969441,0.9969300,0.9969161,0.9969018,0.9968922,0.9968780,0.9968636,0.9968488,0.9968343,0.9968195,0.9968098,0.9967955,0.9967811,0.9967668,0.9967524,0.9967380,0.9967282,0.9967135,0.9966984,0.9966834,0.9966682,0.9966531,0.9966431,0.9966280,0.9966132,0.9965984,0.9965835,0.9965687,0.9965588,0.9965437,0.9965286,0.9965129,0.9964974,0.9964814,0.9964706,0.9964543,0.9964382,0.9964219,0.9964057,0.9963892,0.9963781,0.9963616,0.9963447,0.9963273,0.9963098,0.9962912,0.9962788,0.9962595,0.9962395,0.9962190,0.9961983,0.9961768,0.9961624,0.9961404,0.9961171,0.9960936,0.9960675,0.9960406,0.9960212,0.9959909,0.9959576,0.9959216,0.9958835,0.9958391,0.9958092,0.9957530,0.9956923,0.9956190,0.9955285,0.9954290,0.9953282,0.9951757,0.9949145,0.9945456,0.9939839,0.9928341,0.9918777,0.9891282,0.9857317,0.9794700,0.9729007,0.9653721,0.9612802,0.9570352,0.9576581,0.9619641,0.9692159,0.9740900,0.9805610,0.9860268,0.9897056,0.9919091,0.9934466,0.9938338,0.9944097,0.9946589,0.9948707,0.9949993,0.9950939,0.9951442,0.9952000,0.9952471,0.9952763,0.9953018,0.9953202,0.9953297,0.9953399,0.9953467,0.9953515,0.9953524,0.9953525,0.9953513,0.9953487,0.9953448,0.9953399,0.9953344,0.9953281,0.9953238,0.9953165,0.9953091,0.9953011,0.9952927,0.9952840,0.9952776,0.9952679,0.9952577,0.9952474,0.9952371,0.9952263,0.9952190,0.9952076,0.9951959,0.9951833,0.9951709,0.9951581,0.9951499,0.9951378,0.9951257,0.9951139,0.9951018,0.9950894,0.9950808,0.9950681,0.9950548,0.9950418,0.9950285,0.9950154,0.9950067,0.9949938,0.9949808,0.9949681,0.9949554,0.9949430,0.9949344,0.9949216,0.9949085,0.9948955,0.9948820,0.9948688,0.9948600,0.9948466,0.9948335,0.9948199,0.9948066,0.9947928,0.9947839,0.9947701,0.9947565,0.9947428,0.9947295,0.9947160,0.9947072,0.9946941,0.9946808,0.9946676,0.9946544,0.9946454,0.9946317,0.9946182,0.9946044,0.9945908,0.9945769,0.9945678,0.9945541,0.9945405,0.9945267,0.9945132,0.9944994,0.9944904,0.9944769,0.9944631,0.9944496,0.9944360,0.9944221,0.9944129,0.9943991,0.9943848,0.9943705,0.9943559,0.9943414,0.9943318,0.9943177,0.9943035,0.9942898,0.9942760,0.9942625,0.9942533,0.9942393,0.9942255,0.9942116,0.9941972,0.9941831,0.9941736,0.9941595,0.9941456,0.9941317,0.9941181,0.9941044,0.9940956,0.9940819,0.9940684,0.9940547,0.9940410,0.9940270,0.9940177,0.9940036,0.9939890,0.9939744,0.9939598,0.9939451,0.9939353,0.9939211,0.9939067,0.9938926,0.9938784,0.9938644,0.9938550,0.9938411,0.9938267,0.9938127,0.9937981,0.9937837,0.9937738,0.9937587,0.9937437,0.9937286,0.9937133,0.9936985,0.9936886,0.9936737,0.9936592,0.9936444,0.9936293,0.9936141,0.9936036,0.9935877,0.9935717,0.9935552,0.9935389,0.9935219,0.9935107,0.9934936,0.9934763,0.9934583,0.9934400,0.9934276,0.9934081,0.9933885,0.9933674,0.9933461,0.9933234,0.9933081,0.9932833,0.9932569,0.9932290,0.9931973,0.9931628,0.9931369,0.9930947,0.9930444,0.9929822,0.9929138,0.9928051,0.9927331,0.9925280,0.9922200,0.9917260,0.9907143,0.9894620,0.9876642,0.9849894,0.9809769,0.9773038,0.9741430,0.9721375,0.9726515,0.9752554,0.9783779,0.9823038,0.9858432,0.9884596,0.9897551,0.9909788,0.9916815,0.9921471,0.9923218,0.9924648,0.9925174,0.9925838,0.9926239,0.9926523,0.9926739,0.9926852,0.9926927,0.9926971,0.9927000,0.9926999,0.9926976,0.9926943,0.9926908,0.9926856,0.9926790,0.9926720,0.9926641,0.9926554,0.9926493,0.9926397,0.9926296,0.9926195,0.9926090,0.9925984,0.9925912,0.9925799,0.9925686,0.9925571,0.9925449,0.9925327,0.9925243,0.9925115,0.9924987,0.9924857,0.9924729,0.9924600,0.9924513,0.9924379,0.9924248,0.9924117,0.9923989,0.9923860,0.9923778,0.9923655,0.9923533,0.9923407,0.9923282,0.9923151,0.9923064,0.9922931,0.9922794,0.9922658,0.9922522,0.9922430,0.9922293,0.9922160,0.9922026,0.9921896,0.9921764,0.9921676,0.9921544,0.9921411,0.9921275,0.9921140,0.9921002,0.9920911,0.9920775,0.9920636,0.9920501,0.9920362,0.9920226,0.9920135,0.9919999,0.9919861,0.9919724,0.9919586,0.9919450,0.9919358,0.9919220,0.9919084,0.9918948,0.9918810,0.9918674,0.9918582,0.9918444,0.9918308,0.9918169,0.9918033,0.9917898,0.9917806,0.9917669,0.9917533,0.9917393,0.9917255,0.9917114,0.9917020,0.9916879,0.9916739,0.9916596,0.9916457,0.9916314,0.9916220,0.9916080,0.9915937,0.9915798,0.9915660,0.9915522,0.9915431,0.9915296,0.9915159,0.9915025,0.9914889,0.9914755,0.9914664,0.9914529,0.9914392,0.9914256,0.9914119,0.9913984,0.9913893,0.9913756,0.9913620,0.9913483,0.9913347,0.9913212,0.9913121,0.9912983,0.9912848,0.9912710,0.9912575,0.9912437,0.9912346,0.9912211,0.9912075,0.9911937,0.9911801,0.9911662,0.9911571,0.9911433,0.9911295,0.9911159,0.9911023,0.9910932,0.9910794,0.9910659,0.9910520,0.9910383,0.9910243,0.9910149,0.9910008,0.9909865,0.9909719,0.9909575,0.9909431,0.9909338,0.9909199,0.9909060,0.9908926,0.9908792,0.9908655,0.9908565,0.9908430,0.9908293,0.9908158,0.9908020,0.9907885,0.9907794,0.9907659,0.9907522,0.9907386,0.9907249,0.9907113,0.9907023,0.9906886,0.9906751,0.9906615,0.9906480,0.9906346,0.9906256,0.9906118,0.9905981,0.9905842,0.9905704,0.9905561,0.9905466,0.9905326,0.9905186,0.9905044,0.9904906,0.9904767,0.9904675,0.9904540,0.9904401,0.9904265,0.9904127,0.9903986,0.9903892,0.9903750,0.9903605,0.9903462,0.9903317,0.9903179,0.9903085,0.9902949,0.9902811,0.9902676,0.9902539,0.9902403,0.9902312,0.9902174,0.9902039,0.9901903,0.9901766,0.9901631,0.9901540,0.9901402,0.9901267,0.9901129,0.9900994,0.9900857,0.9900768,0.9900630,0.9900495,0.9900357,0.9900221,0.9900081,0.9899988,0.9899850,0.9899710,0.9899575,0.9899442,0.9899352,0.9899210,0.9899070,0.9898928,0.9898789,0.9898649,0.9898556,0.9898419,0.9898281,0.9898141,0.9898003,0.9897863,0.9897769,0.9897628,0.9897484,0.9897341,0.9897197,0.9897054,0.9896960,0.9896822,0.9896683,0.9896548,0.9896411,0.9896275,0.9896185,0.9896051,0.9895914,0.9895779,0.9895643,0.9895509,0.9895418,0.9895281,0.9895146,0.9895012,0.9894874,0.9894739,0.9894648,0.9894511,0.9894375,0.9894238,0.9894103,0.9893965,0.9893876,0.9893739,0.9893603,0.9893466,0.9893330,0.9893193,0.9893102,0.9892966,0.9892828,0.9892692,0.9892555,0.9892413,0.9892320,0.9892177,0.9892030,0.9891885,0.9891736,0.9891590,0.9891493,0.9891348,0.9891206,0.9891068,0.9890929,0.9890794,0.9890702,0.9890565,0.9890430,0.9890295,0.9890158,0.9890022,0.9889930,0.9889793,0.9889657,0.9889519,0.9889384,0.9889249,0.9889157,0.9889020,0.9888884,0.9888747,0.9888612,0.9888476,0.9888386,0.9888251,0.9888117,0.9887981,0.9887847,0.9887710,0.9887619,0.9887484,0.9887347,0.9887211,0.9887074,0.9886984,0.9886845,0.9886707,0.9886566,0.9886426,0.9886283,0.9886188,0.9886047,0.9885904,0.9885763,0.9885622,0.9885477,0.9885381,0.9885238,0.9885095,0.9884955,0.9884815,0.9884677,0.9884586,0.9884450,0.9884313,0.9884177,0.9884040,0.9883904,0.9883814,0.9883676,0.9883541,0.9883406,0.9883268,0.9883133,0.9883042,0.9882904,0.9882769,0.9882632,0.9882497,0.9882361,0.9882270,0.9882133,0.9881998,0.9881861,0.9881727,0.9881591,0.9881501,0.9881366,0.9881232,0.9881095,0.9880961,0.9880823,0.9880732,0.9880595,0.9880453,0.9880313,0.9880168,0.9880024,0.9879927,0.9879782,0.9879634,0.9879490,0.9879345,0.9879205,0.9879111,0.9878972,0.9878834,0.9878699,0.9878561,0.9878425,0.9878334,0.9878197,0.9878061,0.9877924,0.9877789,0.9877654,0.9877563,0.9877425,0.9877290,0.9877152,0.9877017,0.9876880,0.9876789,0.9876654,0.9876519,0.9876382,0.9876246,0.9876109,0.9876018,0.9875883,0.9875745,0.9875610,0.9875475,0.9875385,0.9875247,0.9875113,0.9874977,0.9874842,0.9874705,0.9874614,0.9874476,0.9874336,0.9874191,0.9874044,0.9873893,0.9873794,0.9873646,0.9873501,0.9873360,0.9873220,0.9873084,0.9872993,0.9872858,0.9872720,0.9872586,0.9872448,0.9872313,0.9872222,0.9872085,0.9871950,0.9871814,0.9871677,0.9871541,0.9871450,0.9871312,0.9871177,0.9871039,0.9870903,0.9870768,0.9870678,0.9870540,0.9870405,0.9870268,0.9870132,0.9869995,0.9869904,0.9869769,0.9869633,0.9869496,0.9869362,0.9869224,0.9869133,0.9868999,0.9868862,0.9868726,0.9868590,0.9868450,0.9868356,0.9868214,0.9868068,0.9867924,0.9867776,0.9867631,0.9867535,0.9867392,0.9867250,0.9867112,0.9866972,0.9866837,0.9866745,0.9866608,0.9866472,0.9866335]
cont = -0.00046147049016336374*np.array(wavel) + 3.7139194821605788
flux = np.array(flux)/np.array(cont)
cont = -0.00046147049016336374*np.array(fitW) + 3.7139194821605788
fitF = np.array(fitF)/np.array(cont)
ax1[1][1].plot(wavel, flux, c=dataColour)
ax1[1][1].plot(fitW, fitF, c=modelColour)
ax1[1][1].plot([5870,5880], [1,1], c=modelColour)
ax1[1][1].plot([5909.90,5920], [1,1], c=modelColour)

ax1[1][1].set_xlim(5885.001,5900-0.00001)
ax1[1][1].set_ylim(leftylim1,leftylim2)


#WD0137
wavel = [3929.020,3929.050,3929.080,3929.110,3929.140,3929.170,3929.200,3929.230,3929.260,3929.290,3929.320,3929.350,3929.380,3929.410,3929.440,3929.470,3929.500,3929.530,3929.560,3929.590,3929.620,3929.650,3929.680,3929.710,3929.740,3929.770,3929.800,3929.830,3929.860,3929.890,3929.920,3929.950,3929.980,3930.010,3930.040,3930.070,3930.100,3930.130,3930.160,3930.190,3930.220,3930.250,3930.280,3930.310,3930.340,3930.370,3930.400,3930.430,3930.460,3930.490,3930.520,3930.550,3930.580,3930.610,3930.640,3930.670,3930.700,3930.730,3930.760,3930.790,3930.820,3930.850,3930.880,3930.910,3930.940,3930.970,3931.000,3931.030,3931.060,3931.090,3931.120,3931.150,3931.180,3931.210,3931.240,3931.270,3931.300,3931.330,3931.360,3931.390,3931.420,3931.450,3931.480,3931.510,3931.540,3931.570,3931.600,3931.630,3931.660,3931.690,3931.720,3931.750,3931.780,3931.810,3931.840,3931.870,3931.900,3931.930,3931.960,3931.990,3932.020,3932.050,3932.080,3932.110,3932.140,3932.170,3932.200,3932.230,3932.260,3932.290,3932.320,3932.350,3932.380,3932.410,3932.440,3932.470,3932.500,3932.530,3932.560,3932.590,3932.620,3932.650,3932.680,3932.710,3932.740,3932.770,3932.800,3932.830,3932.860,3932.890,3932.920,3932.950,3932.980,3933.010,3933.040,3933.070,3933.100,3933.130,3933.160,3933.190,3933.220,3933.250,3933.280,3933.310,3933.340,3933.370,3933.400,3933.430,3933.460,3933.490,3933.520,3933.550,3933.580,3933.610,3933.640,3933.670,3933.700,3933.730,3933.760,3933.790,3933.820,3933.850,3933.880,3933.910,3933.940,3933.970,3934.000,3934.030,3934.060,3934.090,3934.120,3934.150,3934.180,3934.210,3934.240,3934.270,3934.300,3934.330,3934.360,3934.390,3934.420,3934.450,3934.480,3934.510,3934.540,3934.570,3934.600,3934.630,3934.660,3934.690,3934.720,3934.750,3934.780,3934.810,3934.840,3934.870,3934.900,3934.930,3934.960,3934.990,3935.020,3935.050,3935.080,3935.110,3935.140,3935.170,3935.200,3935.230,3935.260,3935.290,3935.320,3935.350,3935.380,3935.410,3935.440,3935.470,3935.500,3935.530,3935.560,3935.590,3935.620,3935.650,3935.680,3935.710,3935.740,3935.770,3935.800,3935.830,3935.860,3935.890,3935.920,3935.950,3935.980,3936.010,3936.040,3936.070,3936.100,3936.130,3936.160,3936.190,3936.220,3936.250,3936.280,3936.310,3936.340,3936.370,3936.400,3936.430,3936.460,3936.490,3936.520,3936.550,3936.580,3936.610,3936.640,3936.670,3936.700,3936.730,3936.760,3936.790,3936.820,3936.850,3936.880,3936.910,3936.940,3936.970,3937.000]
flux = [0.9818783,0.9989611,1.016098,0.9965153,0.9894961,0.9898203,0.9859663,0.9926770,0.9994876,0.9914748,0.9847720,0.9911024,0.9740013,0.9661969,0.9798366,0.9909323,0.9905117,0.9897090,0.9980917,0.9747996,0.9647002,0.9985422,0.9883157,0.9826644,1.004897,0.9994457,0.9890597,0.9996911,0.9898650,0.9789042,0.9709088,0.9733511,0.9813176,0.9779465,0.9759476,0.9731127,0.9778079,0.9732371,0.9833392,0.9870977,0.9785361,0.9873307,0.9769868,0.9904978,0.9962620,0.9892008,1.007502,1.021484,1.012963,1.006333,1.011455,1.020623,1.002571,0.9958528,0.9988962,0.9951263,0.9774811,0.9868199,0.9971041,0.9945085,0.9950606,1.003314,0.9925676,0.9810547,1.022766,1.027585,0.9930469,0.9942185,1.007703,1.000499,0.9957941,1.002316,0.9908044,0.9957135,0.9989049,1.011696,1.014535,1.019732,1.015644,1.013203,1.006244,1.003753,0.9971462,1.001575,0.9955776,1.007851,1.017369,0.9904205,0.9649964,0.9934071,1.018873,1.004300,0.9966695,1.002924,1.001404,1.005979,1.005443,0.9994501,0.9873545,0.9997900,1.015618,1.011074,0.9933939,1.008319,1.017617,1.008244,0.9880615,1.003826,1.027631,1.005284,0.9891964,0.9978780,1.004537,0.9899920,0.9813666,0.9984966,1.001516,1.012574,1.018178,1.014656,1.001264,0.9993536,1.014969,1.029515,1.011064,0.9903189,0.9836503,1.003478,1.015469,1.010522,1.021682,1.017788,1.023056,1.030377,1.033271,1.026149,1.005994,1.003965,0.9922022,0.9701403,0.9694498,0.9933150,0.9981610,1.007088,1.009302,0.9980444,0.9755865,0.9801705,0.9855711,0.9776590,0.9972146,1.000934,0.9832401,0.9730777,0.9741344,0.9824567,0.9910796,0.9916307,0.9882368,0.9962059,0.9988760,0.9925597,0.9778228,0.9634314,0.9732091,0.9680661,0.9800627,0.9790926,0.9848753,0.9909937,0.9934947,1.010757,1.008199,1.000416,0.9963549,0.9916255,0.9878363,0.9877864,0.9931239,0.9942605,1.009400,1.015174,1.008536,1.000702,1.000303,1.004087,0.9837695,0.9835188,0.9941966,0.9910279,1.006327,1.013183,0.9896609,0.9965951,1.002240,1.009475,1.009016,0.9921890,0.9797910,0.9759852,0.9869128,1.009207,0.9982119,0.9850007,0.9966037,0.9840218,0.9969823,1.016867,1.017707,1.011827,0.9859865,0.9982951,0.9970016,0.9853240,0.9768257,0.9761631,0.9825514,0.9811274,0.9887547,1.001270,1.002008,1.006073,1.012067,1.009021,0.9945971,0.9805998,0.9854861,1.005094,1.003487,0.9831604,0.9905328,0.9906607,0.9754936,0.9885497,1.000505,1.000553,0.9995350,0.9906405,0.9809293,0.9991941,0.9845389,0.9806122,0.9832954,0.9947714,1.009379,0.9973101,0.9757259,0.9914722,1.002019,0.9746287,0.9664273,1.001221,1.000229,0.9965013,0.9925333,0.9830394,0.9689968,0.9681615,0.9945121,0.9924396,0.9920496,0.9830105,0.9772304,0.9873894,0.9898010,0.9992011,1.001244]
fitW = [3929.00,3930.040,3930.070,3930.100,3930.130,3930.160,3930.190,3930.220,3930.250,3930.280,3930.310,3930.340,3930.370,3930.400,3930.430,3930.460,3930.490,3930.520,3930.550,3930.580,3930.610,3930.640,3930.670,3930.700,3930.730,3930.760,3930.790,3930.820,3930.850,3930.880,3930.910,3930.940,3930.970,3931.000,3931.030,3931.060,3931.090,3931.120,3931.150,3931.180,3931.210,3931.240,3931.270,3931.300,3931.330,3931.360,3931.390,3931.420,3931.450,3931.480,3931.510,3931.540,3931.570,3931.600,3931.630,3931.660,3931.690,3931.720,3931.750,3931.780,3931.810,3931.840,3931.870,3931.900,3931.930,3931.960,3931.990,3932.020,3932.050,3932.080,3932.110,3932.140,3932.170,3932.200,3932.230,3932.260,3932.290,3932.320,3932.350,3932.380,3932.410,3932.440,3932.470,3932.500,3932.530,3932.560,3932.590,3932.620,3932.650,3932.680,3932.710,3932.740,3932.770,3932.800,3932.830,3932.860,3932.890,3932.920,3932.950,3932.980,3933.010,3933.040,3933.070,3933.100,3933.130,3933.160,3933.190,3933.220,3933.250,3933.280,3933.310,3933.340,3933.370,3933.400,3933.430,3933.460,3933.490,3933.520,3933.550,3933.580,3933.610,3933.640,3933.670,3933.700,3933.730,3933.760,3933.790,3933.820,3933.850,3933.880,3933.910,3933.940,3933.970,3934.000,3934.030,3934.060,3934.090,3934.120,3934.150,3934.180,3934.210,3934.240,3934.270,3934.300,3934.330,3934.360,3934.390,3934.420,3934.450,3934.480,3934.510,3934.540,3934.570,3934.600,3934.630,3934.660,3934.690,3934.720,3934.750,3934.780,3934.810,3934.840,3934.870,3934.900,3934.930,3934.960,3934.990,3935.020,3935.050,3935.080,3935.110,3935.140,3935.170,3935.200,3935.230,3935.260,3935.290,3935.320,3935.350,3935.380,3935.410,3935.440,3935.470,3935.500,3935.530,3935.560,3935.590,3935.620,3935.650,3935.680,3935.710,3935.740,3935.770,3935.800,3935.830,3935.860,3935.890,3935.920,3935.950,3937.980]
fitF = [0.9988340,0.9988695,0.9989051,0.9989408,0.9989752,0.9990094,0.9990429,0.9990752,0.9991069,0.9991371,0.9991658,0.9991927,0.9992187,0.9992441,0.9992694,0.9992948,0.9993206,0.9993465,0.9993725,0.9993967,0.9994203,0.9994422,0.9994636,0.9994847,0.9995070,0.9995301,0.9995547,0.9995801,0.9996058,0.9996295,0.9996524,0.9996732,0.9996925,0.9997109,0.9997283,0.9997455,0.9997624,0.9997783,0.9997937,0.9998063,0.9998178,0.9998272,0.9998353,0.9998426,0.9998514,0.9998610,0.9998721,0.9998844,0.9998971,0.9999089,0.9999198,0.9999291,0.9999368,0.9999438,0.9999503,0.9999568,0.9999632,0.9999692,0.9999751,0.9999800,0.9999846,0.9999888,0.9999924,0.9999955,0.9999974,0.9999990,0.9999999,0.9999999,0.9999993,0.9999982,0.9999965,0.9999940,0.9999908,0.9999872,0.9999819,0.9999763,0.9999700,0.9999635,0.9999570,0.9999506,0.9999443,0.9999383,0.9999318,0.9999248,0.9999167,0.9999080,0.9998981,0.9998876,0.9998769,0.9998649,0.9998524,0.9998388,0.9998237,0.9998077,0.9997895,0.9997707,0.9997509,0.9997303,0.9997095,0.9996877,0.9996654,0.9996424,0.9996182,0.9995936,0.9995667,0.9995381,0.9995068,0.9994699,0.9994301,0.9993715,0.9992937,0.9991773,0.9989150,0.9985824,0.9974877,0.9957524,0.9927356,0.9878189,0.9819518,0.9741386,0.9671631,0.9619073,0.9607984,0.9637031,0.9704576,0.9773461,0.9845022,0.9898204,0.9942198,0.9961112,0.9975746,0.9981506,0.9984361,0.9985762,0.9985998,0.9986131,0.9986057,0.9985902,0.9985707,0.9985442,0.9985157,0.9984837,0.9984496,0.9984143,0.9983768,0.9983389,0.9983011,0.9982622,0.9982231,0.9981831,0.9981426,0.9981011,0.9980583,0.9980150,0.9979704,0.9979249,0.9978784,0.9978311,0.9977835,0.9977343,0.9976845,0.9976336,0.9975822,0.9975308,0.9974791,0.9974272,0.9973749,0.9973219,0.9972686,0.9972133,0.9971573,0.9971006,0.9970425,0.9969839,0.9969246,0.9968652,0.9968055,0.9967457,0.9966858,0.9966260,0.9965654,0.9965042,0.9964417,0.9963784,0.9963123,0.9962454,0.9961768,0.9961079,0.9960392,0.9959709,0.9959026,0.9958342,0.9957649,0.9956949,0.9956226,0.9955502,0.9954779,0.9954051,0.9953337,0.9952617]
cont = -0.0005983752093803331*np.array(fitW) + 3.350454556616804
fitF = np.array(fitF)/cont
cont = -0.0005983752093803331*np.array(wavel) + 3.350454556616804
flux = np.array(flux)/cont
ax1[2][0].plot(fitW, fitF, c=modelColour)
ax1[2][0].plot(wavel, flux, c=dataColour)
ax1[2][0].set_xlim(rightxlim1,rightxlim2)
ax1[2][0].set_ylim(leftylim1,leftylim2)

wavel = [5869.000,5869.200,5869.400,5869.600,5869.800,5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000,5920.200,5920.400,5920.600,5920.800,5921.000]
flux = [0.9978016,0.9966191,0.9978992,1.002650,0.9998441,0.9979441,0.9985124,0.9985508,0.9965361,0.9975640,0.9998323,0.9985458,0.9922569,0.9986297,0.9992104,0.9933840,0.9905584,0.9970879,0.9986638,0.9970664,0.9948625,0.9958109,0.9926369,0.9892585,0.9872402,0.9926366,0.9981403,0.9979554,0.9916790,0.9879248,0.9937624,0.9912806,0.9881070,0.9959090,0.9944010,0.9919639,0.9934304,0.9942855,0.9923243,0.9939737,0.9964671,0.9968047,1.000566,0.9959283,0.9940601,0.9904986,0.9947171,0.9963424,0.9937645,0.9900911,0.9889464,0.9959152,0.9950849,0.9923410,0.9928774,0.9955802,0.9932764,0.9884008,0.9890602,0.9882444,0.9863461,0.9846869,0.9878333,0.9887436,0.9901626,0.9896106,0.9869488,0.9867035,0.9916372,0.9936665,0.9914784,0.9912273,0.9887645,0.9880446,0.9862946,0.9879587,0.9914496,0.9905318,0.9892260,0.9926882,0.9924485,0.9892344,0.9898620,0.9904146,0.9927883,0.9847462,0.9927512,0.9948058,0.9897641,0.9860727,0.9897913,0.9922009,0.9908136,0.9929563,0.9903213,0.9932696,0.9969452,0.9981811,0.9934748,0.9962094,0.9907444,0.9854589,0.9910684,0.9907513,0.9851900,0.9779785,0.9805184,0.9902333,0.9918869,0.9897411,0.9880229,0.9857033,0.9874776,0.9830964,0.9804065,0.9851358,0.9864914,0.9858120,0.9922696,0.9976004,0.9902546,0.9933327,0.9939970,0.9895982,0.9897690,0.9880326,0.9834230,0.9850318,0.9856626,0.9870557,0.9934896,0.9869606,0.9846810,0.9948213,0.9920727,0.9827390,0.9879747,0.9868475,0.9749649,0.9820563,0.9862471,0.9818212,0.9764553,0.9739693,0.9781753,0.9761152,0.9794367,0.9878974,0.9841856,0.9822962,0.9862328,0.9882208,0.9818521,0.9816988,0.9778644,0.9718127,0.9713575,0.9767426,0.9828239,0.9784790,0.9765526,0.9809668,0.9848427,0.9712195,0.9701322,0.9801109,0.9788834,0.9822460,0.9839929,0.9833646,0.9833993,0.9857268,0.9780270,0.9753613,0.9765161,0.9779720,0.9854773,0.9790738,0.9779013,0.9806887,0.9773492,0.9743724,0.9730987,0.9726298,0.9785416,0.9778914,0.9761702,0.9805978,0.9723088,0.9723115,0.9774158,0.9712612,0.9764131,0.9748723,0.9689734,0.9692954,0.9742643,0.9744451,0.9724135,0.9698040,0.9717000,0.9702315,0.9721777,0.9779285,0.9766302,0.9768834,0.9698174,0.9703553,0.9718217,0.9721310,0.9714817,0.9743157,0.9754288,0.9752039,0.9750295,0.9770933,0.9779502,0.9655570,0.9678277,0.9680398,0.9690631,0.9720091,0.9782782,0.9726210,0.9673989,0.9727705,0.9690119,0.9656487,0.9705057,0.9680611,0.9595881,0.9635639,0.9656371,0.9612561,0.9602849,0.9635872,0.9650550,0.9661724,0.9657056,0.9672990,0.9635097,0.9610190,0.9631917,0.9575318,0.9575449,0.9592476,0.9566894,0.9583534,0.9581281,0.9568476,0.9576964,0.9560113,0.9518124,0.9508467,0.9560084,0.9604017,0.9633268,0.9657278,0.9654060,0.9640517,0.9662200]
fitW = [5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000]
fitF = [1.000874,1.000728,1.000581,1.000436,1.000291,1.000146,0.9999999,0.9998546,0.9997101,0.9995663,0.9994207,0.9992743,0.9991289,0.9989840,0.9988402,0.9986957,0.9985510,0.9984062,0.9982611,0.9981157,0.9979702,0.9978259,0.9976821,0.9975366,0.9973906,0.9972450,0.9971001,0.9969564,0.9968121,0.9966681,0.9965237,0.9963783,0.9962327,0.9960873,0.9959434,0.9957995,0.9956546,0.9955100,0.9953662,0.9952223,0.9950771,0.9949314,0.9947865,0.9946417,0.9944980,0.9943536,0.9942091,0.9940646,0.9939195,0.9937743,0.9936293,0.9934856,0.9933418,0.9931965,0.9930509,0.9929056,0.9927610,0.9926175,0.9924735,0.9923296,0.9921853,0.9920415,0.9918980,0.9917538,0.9916096,0.9914643,0.9913189,0.9911747,0.9910311,0.9908870,0.9907416,0.9905962,0.9904520,0.9903082,0.9901650,0.9900210,0.9898766,0.9897330,0.9895890,0.9894449,0.9892991,0.9891533,0.9890085,0.9888645,0.9887205,0.9885755,0.9884296,0.9882835,0.9881371,0.9879914,0.9878450,0.9876958,0.9875425,0.9873834,0.9872112,0.9869670,0.9863019,0.9841625,0.9790944,0.9727137,0.9707990,0.9752192,0.9812767,0.9845260,0.9855170,0.9856071,0.9855087,0.9853786,0.9852419,0.9851031,0.9849626,0.9848217,0.9846809,0.9845392,0.9843971,0.9842535,0.9841095,0.9839661,0.9838228,0.9836794,0.9835350,0.9833893,0.9832423,0.9830914,0.9829312,0.9827180,0.9822119,0.9806738,0.9773386,0.9740362,0.9735096,0.9759236,0.9793525,0.9810153,0.9813961,0.9813542,0.9812296,0.9810920,0.9809505,0.9808089,0.9806669,0.9805251,0.9803838,0.9802424,0.9801006,0.9799577,0.9798141,0.9796707,0.9795279,0.9793863,0.9792448,0.9791021,0.9789587,0.9788151,0.9786732,0.9785308,0.9783881,0.9782452,0.9781020,0.9779590,0.9778157,0.9776725,0.9775296,0.9773864,0.9772430,0.9770995,0.9769564,0.9768137,0.9766703,0.9765277,0.9763845,0.9762414,0.9760984,0.9759554,0.9758127,0.9756694,0.9755263,0.9753838,0.9752407,0.9750978,0.9749553,0.9748135,0.9746724,0.9745296,0.9743862,0.9742428,0.9741004,0.9739577,0.9738142,0.9736718,0.9735296,0.9733864,0.9732432,0.9731005,0.9729584,0.9728151,0.9726717,0.9725297,0.9723871,0.9722440,0.9721010,0.9719595,0.9718181,0.9716757,0.9715331,0.9713905,0.9712477,0.9711052,0.9709622,0.9708200,0.9706773,0.9705342,0.9703920,0.9702502,0.9701094,0.9699673,0.9698242,0.9696816,0.9695396,0.9693972,0.9692540,0.9691113,0.9689696,0.9688267,0.9686839,0.9685419,0.9684007,0.9682592,0.9681165,0.9679744,0.9678320,0.9676895,0.9675469,0.9674049,0.9672638,0.9671227,0.9669805,0.9668378,0.9666953,0.9665538,0.9664111,0.9662681,0.9661266,0.9659856,0.9658442,0.9657018,0.9655594,0.9654175,0.9652751,0.9651328,0.9649909]
cont = -0.0007176619999999675*np.array(wavel) + 5.213549939999808
flux = np.array(flux)/cont
cont = -0.0007176619999999675*np.array(fitW) + 5.213549939999808
fitF = np.array(fitF)/cont
ax1[2][1].plot(wavel, flux, c=dataColour)
ax1[2][1].plot(fitW, fitF, c=modelColour)
ax1[2][1].set_xlim(5885.001,5900-0.00001)
ax1[2][1].set_ylim(leftylim1,leftylim2)

#J1411
wavel = [3929.000,3929.200,3929.400,3929.600,3929.800,3930.000,3930.200,3930.400,3930.600,3930.800,3931.000,3931.200,3931.400,3931.600,3931.800,3932.000,3932.200,3932.400,3932.600,3932.800,3933.000,3933.200,3933.400,3933.600,3933.800,3934.000,3934.200,3934.400,3934.600,3934.800,3935.000,3935.200,3935.400,3935.600,3935.800,3936.000,3936.200,3936.400,3936.600,3936.800,3937.000]
flux = [1.020530,0.9676717,0.9958994,1.018268,1.013625,1.017225,1.010249,1.021634,1.000113,0.9687443,0.9845641,1.015163,1.005628,0.9830543,0.9923148,1.000842,1.000486,0.9963511,0.9722630,0.9560328,0.9866371,0.9787703,0.9579806,0.9705896,0.9884943,0.9832491,0.9974749,0.9983299,0.9876859,0.9736447,0.9797779,0.9852398,0.9756675,0.9847387,0.9957860,1.007556,1.000024,0.9912093,1.002607,0.9823182,0.9705403]
fitW = [3929.000,3930.200,3930.400,3930.600,3930.800,3931.000,3931.200,3931.400,3931.600,3931.800,3932.000,3932.200,3932.400,3932.600,3932.800,3933.000,3933.200,3933.400,3933.600,3933.800,3934.000,3934.200,3934.400,3934.600,3934.800,3935.000,3935.200,3935.400,3935.600,3935.800,3937.000]
fitF = [1.000559,1.000517,1.000455,1.000372,1.000269,1.000146,1.000000,0.9998317,0.9996390,0.9994194,0.9991679,0.9988749,0.9985080,0.9979011,0.9962554,0.9906622,0.9767341,0.9552394,0.9394392,0.9444896,0.9619794,0.9808455,0.9905158,0.9933763,0.9936883,0.9933674,0.9929009,0.9923757,0.9918107,0.9912147,0.9905900]
cont = -0.0016615000000002717*np.array(wavel) + 7.530254000001068
flux = np.array(flux)/cont
cont = -0.0016615000000002717*np.array(fitW) + 7.530254000001068
fitF = np.array(fitF)/cont
ax1[3][0].plot(fitW, fitF, c=modelColour)
ax1[3][0].plot(wavel, flux, c=dataColour)
ax1[3][0].set_xlim(rightxlim1,rightxlim2)
ax1[3][0].set_ylim(leftylim1,leftylim2)
wavel = [5869.000,5869.200,5869.400,5869.600,5869.800,5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000,5920.200,5920.400,5920.600,5920.800,5921.000]
flux = [1.003742,0.9826105,0.9707059,0.9669193,0.9639210,0.9953374,0.9858720,1.003448,0.9930549,0.9619676,0.9898881,1.028068,0.9878359,1.031966,0.9948205,0.9759875,0.9615852,0.9537659,0.9852090,1.002054,1.012787,1.014753,1.020646,1.003781,0.9913104,1.021410,0.9938779,0.9472754,0.9446180,0.9736102,1.012457,1.014997,0.9863284,0.9739584,0.9561927,0.9477798,1.001301,1.030220,0.9952446,1.005946,1.006927,0.9876691,0.9659561,0.9992078,1.045742,1.040266,0.9911880,0.9711514,0.9449104,0.9570707,1.012746,1.035091,1.007699,1.008647,1.001094,1.010811,0.9936307,0.9814199,0.9774538,0.9903792,1.008198,0.9661891,0.9871234,1.023707,0.9911082,0.9588929,0.9901043,1.019406,0.9844838,0.9832345,1.011656,0.9814932,0.9905763,0.9864640,1.007090,1.017620,1.012991,1.040617,1.013483,0.9758806,0.9740276,0.9768618,1.002880,0.9979889,0.9991562,0.9585274,0.9750683,1.024271,0.9611761,0.9754234,1.007999,0.9911298,1.005339,1.007813,0.9637275,0.9696842,0.9891591,0.9918733,0.9995050,0.9651131,0.9691279,1.024948,1.099768,1.087911,1.048483,0.9913755,0.9248031,0.9729570,0.9715185,1.025030,0.9818050,0.9780735,0.9615200,0.9463127,0.9756668,1.014469,1.036719,1.010344,1.001931,0.9984519,0.9854379,0.9597840,0.9547611,1.002677,1.008486,1.025115,0.9924045,0.9917281,0.9962604,0.9855862,0.9734260,0.9798082,1.016304,0.9659045,0.9485095,0.9790847,0.9886163,0.9964325,0.9893704,0.9625496,0.9596106,0.9461905,0.9667172,0.9582025,0.9718409,0.9883958,0.9676665,0.9892733,0.9948094,1.005937,0.9786022,0.9422854,0.9563013,0.9681224,0.9918694,1.005245,0.9985447,0.9610716,0.9937072,1.008217,0.9985642,0.9582689,0.9611720,0.9412312,0.9506514,0.9772611,0.9639180,0.9948852,1.039425,1.036099,0.9871049,0.9695610,1.017017,1.010246,0.9833037,0.9964365,0.9779792,0.9625769,0.9528727,0.9405094,0.9474305,0.9705387,0.9954444,0.9437274,0.9492690,0.9730765,0.9543924,0.9891458,1.004866,0.9966241,0.9759516,1.015453,0.9876140,0.9560578,0.9668292,0.9693086,0.9494055,0.9457746,0.9770937,0.9869421,0.9998049,1.053187,1.034488,1.008843,0.9381392,0.9878086,1.000419,0.9623954,0.9915136,0.9845846,0.9702131,0.9734223,1.024666,1.008828,0.9903011,0.9933656,0.9279277,0.9426860,0.9790874,0.9910064,0.9611427,0.9941826,1.016290,0.9434975,0.9398625,0.9819956,1.001638,0.9805465,1.043885,0.9936328,0.9587653,0.9729419,0.9600694,0.9428713,0.8920629,0.9229258,0.9834167,0.9873089,0.9928624,1.011946,0.9906400,0.9410307,0.9756035,0.9915403,0.9771356,0.9842771,0.9698662,0.9538514,0.9553632,0.9744467,0.9708584,0.9443188,0.9565746,0.9698958,0.9741498,0.9554918,0.9416932,0.9502311,0.9574458,0.9514764,0.9439909]
fitW = [5870.000,5870.200,5870.400,5870.600,5870.800,5871.000,5871.200,5871.400,5871.600,5871.800,5872.000,5872.200,5872.400,5872.600,5872.800,5873.000,5873.200,5873.400,5873.600,5873.800,5874.000,5874.200,5874.400,5874.600,5874.800,5875.000,5875.200,5875.400,5875.600,5875.800,5876.000,5876.200,5876.400,5876.600,5876.800,5877.000,5877.200,5877.400,5877.600,5877.800,5878.000,5878.200,5878.400,5878.600,5878.800,5879.000,5879.200,5879.400,5879.600,5879.800,5880.000,5880.200,5880.400,5880.600,5880.800,5881.000,5881.200,5881.400,5881.600,5881.800,5882.000,5882.200,5882.400,5882.600,5882.800,5883.000,5883.200,5883.400,5883.600,5883.800,5884.000,5884.200,5884.400,5884.600,5884.800,5885.000,5885.200,5885.400,5885.600,5885.800,5886.000,5886.200,5886.400,5886.600,5886.800,5887.000,5887.200,5887.400,5887.600,5887.800,5888.000,5888.200,5888.400,5888.600,5888.800,5889.000,5889.200,5889.400,5889.600,5889.800,5890.000,5890.200,5890.400,5890.600,5890.800,5891.000,5891.200,5891.400,5891.600,5891.800,5892.000,5892.200,5892.400,5892.600,5892.800,5893.000,5893.200,5893.400,5893.600,5893.800,5894.000,5894.200,5894.400,5894.600,5894.800,5895.000,5895.200,5895.400,5895.600,5895.800,5896.000,5896.200,5896.400,5896.600,5896.800,5897.000,5897.200,5897.400,5897.600,5897.800,5898.000,5898.200,5898.400,5898.600,5898.800,5899.000,5899.200,5899.400,5899.600,5899.800,5900.000,5900.200,5900.400,5900.600,5900.800,5901.000,5901.200,5901.400,5901.600,5901.800,5902.000,5902.200,5902.400,5902.600,5902.800,5903.000,5903.200,5903.400,5903.600,5903.800,5904.000,5904.200,5904.400,5904.600,5904.800,5905.000,5905.200,5905.400,5905.600,5905.800,5906.000,5906.200,5906.400,5906.600,5906.800,5907.000,5907.200,5907.400,5907.600,5907.800,5908.000,5908.200,5908.400,5908.600,5908.800,5909.000,5909.200,5909.400,5909.600,5909.800,5910.000,5910.200,5910.400,5910.600,5910.800,5911.000,5911.200,5911.400,5911.600,5911.800,5912.000,5912.200,5912.400,5912.600,5912.800,5913.000,5913.200,5913.400,5913.600,5913.800,5914.000,5914.200,5914.400,5914.600,5914.800,5915.000,5915.200,5915.400,5915.600,5915.800,5916.000,5916.200,5916.400,5916.600,5916.800,5917.000,5917.200,5917.400,5917.600,5917.800,5918.000,5918.200,5918.400,5918.600,5918.800,5919.000,5919.200,5919.400,5919.600,5919.800,5920.000]
fitF = [1.000654,1.000545,1.000436,1.000327,1.000218,1.000109,1.000000,0.9998912,0.9997821,0.9996731,0.9995638,0.9994545,0.9993458,0.9992368,0.9991279,0.9990186,0.9989095,0.9988007,0.9986917,0.9985830,0.9984739,0.9983647,0.9982558,0.9981467,0.9980381,0.9979292,0.9978201,0.9977114,0.9976022,0.9974932,0.9973844,0.9972749,0.9971662,0.9970576,0.9969490,0.9968401,0.9967312,0.9966225,0.9965134,0.9964044,0.9962952,0.9961861,0.9960772,0.9959683,0.9958595,0.9957504,0.9956413,0.9955323,0.9954233,0.9953146,0.9952058,0.9950969,0.9949882,0.9948789,0.9947696,0.9946601,0.9945506,0.9944417,0.9943326,0.9942237,0.9941145,0.9940053,0.9938964,0.9937871,0.9936779,0.9935683,0.9934586,0.9933492,0.9932393,0.9931294,0.9930190,0.9929085,0.9927982,0.9926875,0.9925771,0.9924663,0.9923556,0.9922448,0.9921332,0.9920213,0.9919083,0.9917945,0.9916800,0.9915640,0.9914468,0.9913275,0.9912059,0.9910818,0.9909530,0.9908181,0.9906735,0.9905146,0.9903327,0.9901062,0.9897740,0.9890462,0.9865741,0.9784968,0.9603177,0.9386417,0.9325477,0.9480532,0.9697745,0.9826947,0.9872311,0.9883434,0.9885932,0.9886425,0.9886255,0.9885767,0.9885089,0.9884287,0.9883400,0.9882452,0.9881463,0.9880438,0.9879385,0.9878303,0.9877178,0.9876010,0.9874783,0.9873477,0.9872043,0.9870350,0.9867998,0.9862801,0.9844311,0.9783121,0.9652252,0.9516922,0.9498624,0.9610638,0.9752228,0.9827620,0.9850883,0.9855666,0.9856247,0.9855919,0.9855289,0.9854509,0.9853637,0.9852706,0.9851738,0.9850742,0.9849731,0.9848703,0.9847668,0.9846631,0.9845589,0.9844543,0.9843487,0.9842426,0.9841365,0.9840299,0.9839235,0.9838167,0.9837099,0.9836034,0.9834965,0.9833896,0.9832821,0.9831746,0.9830670,0.9829594,0.9828523,0.9827447,0.9826373,0.9825302,0.9824225,0.9823147,0.9822069,0.9820995,0.9819923,0.9818847,0.9817773,0.9816697,0.9815622,0.9814549,0.9813469,0.9812389,0.9811308,0.9810231,0.9809158,0.9808081,0.9807008,0.9805930,0.9804850,0.9803772,0.9802694,0.9801621,0.9800546,0.9799469,0.9798391,0.9797312,0.9796236,0.9795159,0.9794080,0.9793004,0.9791926,0.9790853,0.9789778,0.9788701,0.9787624,0.9786544,0.9785472,0.9784397,0.9783322,0.9782245,0.9781166,0.9780090,0.9779013,0.9777936,0.9776859,0.9775781,0.9774708,0.9773632,0.9772553,0.9771476,0.9770399,0.9769327,0.9768250,0.9767171,0.9766095,0.9765020,0.9763948,0.9762874,0.9761797,0.9760723,0.9759645,0.9758571,0.9757495,0.9756419,0.9755344,0.9754267,0.9753193,0.9752117,0.9751041,0.9749967,0.9748890,0.9747817,0.9746740,0.9745664,0.9744591,0.9743516,0.9742446,0.9741371,0.9740295,0.9739220,0.9738144,0.9737074,0.9736000]
cont = -0.0005410799999999727*np.array(wavel) + 4.176793599999839
flux = np.array(flux)/cont
cont = -0.0005410799999999727*np.array(fitW) + 4.176793599999839
fitF = np.array(fitF)/cont
ax1[3][1].plot(wavel, flux, c=dataColour)
ax1[3][1].plot(fitW, fitF, c=modelColour)
ax1[3][1].set_xlim(5885.001,5900-0.00001)
ax1[3][1].set_ylim(leftylim1,leftylim2)
ax1[0][0].yaxis.set_label_position("right")
ax1[0][1].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[0][1].tick_params(axis='y',which='major', length=14,direction="in")
ax1[0][1].tick_params(axis='x',which='both', width=2,direction='in')
ax1[0][1].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[0][1].tick_params(axis='x',which='minor', length=8)
ax1[0][1].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[0][1].tick_params(labelsize=26)
ax1[1][1].tick_params(labelsize=26)
ax1[2][1].tick_params(labelsize=26)
ax1[3][1].tick_params(labelsize=26)
ax1[0][0].tick_params(labelsize=26)
ax1[1][0].tick_params(labelsize=26)
ax1[2][0].tick_params(labelsize=26)
ax1[3][0].tick_params(labelsize=26)
ax1[0][1].xaxis.set_ticks_position('both')
ax1[0][1].yaxis.set_ticks_position('both')
ax1[1][1].yaxis.set_ticks_position('both')
ax1[1][1].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[1][1].tick_params(axis='y',which='major', length=14,direction="in")
ax1[1][1].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[2][1].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[2][1].tick_params(axis='y',which='major', length=14,direction="in")
ax1[2][1].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[3][1].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[3][1].tick_params(axis='y',which='major', length=14,direction="in")
ax1[3][1].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[1][1].tick_params(axis='x',which='both', width=2,direction='in')
ax1[1][1].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[1][1].tick_params(axis='x',which='minor', length=8)
ax1[2][1].tick_params(axis='x',which='both', width=2,direction='in')
ax1[2][1].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[2][1].tick_params(axis='x',which='minor', length=8)
ax1[3][1].tick_params(axis='x',which='both', width=2,direction='in')
ax1[3][1].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[3][1].tick_params(axis='x',which='minor', length=8)
ax1[1][1].xaxis.set_ticks_position('both')
ax1[2][1].xaxis.set_ticks_position('both')
ax1[3][1].xaxis.set_ticks_position('both')
ax1[1][1].yaxis.set_ticks_position('both')
ax1[2][1].yaxis.set_ticks_position('both')
ax1[3][1].yaxis.set_ticks_position('both')
ax1[0][1].set_xticklabels([])
ax1[1][1].set_xticklabels([])
ax1[2][1].set_xticklabels([])
ax1[0][0].set_xticklabels([])
ax1[1][0].set_xticklabels([])
ax1[2][0].set_xticklabels([])
ax1[0][0].yaxis.set_ticks_position('both')
ax1[1][0].yaxis.set_ticks_position('both')
ax1[2][0].yaxis.set_ticks_position('both')
ax1[3][0].yaxis.set_ticks_position('both')
ax1[0][0].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[0][0].tick_params(axis='y',which='major', length=14,direction="in")
ax1[0][0].tick_params(axis='x',which='both', width=2,direction='in')
ax1[0][0].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[0][0].tick_params(axis='x',which='minor', length=8)
ax1[0][0].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[0][0].tick_params(labelsize=26)
ax1[0][0].xaxis.set_ticks_position('both')
ax1[0][0].yaxis.set_ticks_position('both')
ax1[0][0].tick_params(labelright='on')
ax1[1][0].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[1][0].tick_params(axis='y',which='major', length=14,direction="in")
ax1[1][0].tick_params(axis='x',which='both', width=2,direction='in')
ax1[1][0].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[1][0].tick_params(axis='x',which='minor', length=8)
ax1[1][0].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[1][0].xaxis.set_ticks_position('both')
ax1[1][0].yaxis.set_ticks_position('both')
ax1[1][0].tick_params(labelright='on')
ax1[2][0].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[2][0].tick_params(axis='y',which='major', length=14,direction="in")
ax1[2][0].tick_params(axis='x',which='both', width=2,direction='in')
ax1[2][0].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[2][0].tick_params(axis='x',which='minor', length=8)
ax1[2][0].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[2][0].xaxis.set_ticks_position('both')
ax1[2][0].yaxis.set_ticks_position('both')
ax1[2][0].tick_params(labelright='on')
ax1[3][0].tick_params(axis='y',which='both', width=2,direction="in",pad=10)
ax1[3][0].tick_params(axis='y',which='major', length=14,direction="in")
ax1[3][0].tick_params(axis='x',which='both', width=2,direction='in')
ax1[3][0].tick_params(axis='x',which='major', length=14,direction='in',pad=10)
ax1[3][0].tick_params(axis='x',which='minor', length=8)
ax1[3][0].tick_params(axis='y',which='minor', length=8,direction='in')
ax1[3][0].xaxis.set_ticks_position('both')
ax1[3][0].yaxis.set_ticks_position('both')
ax1[3][0].tick_params(labelright='on')
ax1[0][1].tick_params(labelleft=False)   
ax1[1][1].tick_params(labelleft=False)   
ax1[2][1].tick_params(labelleft=False)   
ax1[3][1].tick_params(labelleft=False)   


ax1[0][1].xaxis.set_major_locator(MultipleLocator(3))
ax1[1][1].xaxis.set_major_locator(MultipleLocator(3))
ax1[2][1].xaxis.set_major_locator(MultipleLocator(3))
ax1[3][1].xaxis.set_major_locator(MultipleLocator(3))
xpos = 3931.2
ypos = 0.87

ax1[0][1].annotate('Na I', (5890, 1.075),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(0, 10), ha="center", fontsize=26)


ax1[0][1].annotate('Na I', (5896, 1.075),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(0, 10), ha="center", fontsize=26)
ax1[0][1].annotate('S/N = 88', (5897.8, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[1][1].annotate('S/N = 107', (5897.6, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[2][1].annotate('S/N = 283', (5897.6, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[3][1].annotate('S/N = 40', (5897.8, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[0][0].annotate('Ca II K', (3933.6, 1.075),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(0, 10), ha="center", fontsize=26)
ax1[0][0].annotate('S/N = 65', (3936, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[1][0].annotate('S/N = 72', (3936, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[2][0].annotate('S/N = 98', (3936, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[3][0].annotate('S/N = 53', (3936, 0.87),
                   xycoords = 'data',
                   textcoords="offset points", 
                   xytext=(0, 10), ha="center", fontsize=26)
ax1[0][0].annotate('NLTT 5306', (xpos, ypos),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(-5, 10), ha="center", fontsize=26)
ax1[1][0].annotate('GD 1400', (xpos, ypos),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(-20, 10), ha="center", fontsize=26)
ax1[2][0].annotate('WD 0137-349', (xpos, ypos),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(15, 10), ha="center", fontsize=26)
ax1[3][0].annotate('SDSS J1411', (xpos, ypos),
                 xycoords="data",
                 textcoords="offset points",
                 xytext=(0, 10), ha="center", fontsize=26)




ax1[0][1].plot([5896,5896],[1.025,1.075],c='k')
ax1[0][1].plot([5890,5890],[1.025,1.075],c='k')
ax1[0][0].plot([3933.6,3933.6],[1.025,1.075],c='k')
fig.text(0.5, 0.065, 'Wavelength ()', fontsize=26, ha='center')
fig.text(0.07, 0.5, 'Relative flux', fontsize=26, va='center', rotation='vertical')
bboxx = transforms.Bbox([[1.38, 1.2], [18.1, 17.7]])
plt.savefig('SpectralFitsMass.pdf', bbox_inches=bboxx)